rules:
  - id: wp-xss-taint-to-output
    message: "XSS: user-controlled data flows to output without escaping."
    languages: [php]
    severity: ERROR
    mode: taint

    # 1) Sources
    pattern-sources:
      - pattern: $_GET[$X]
      - pattern: $_POST[$X]
      - pattern: $_REQUEST[$X]
      - pattern: $_COOKIE[$X]

    # 2) Sanitizers (적절히 이스케이프/세정된 경우 제외)
    pattern-sanitizers:
      - pattern: esc_html($X)
      - pattern: esc_attr($X)
      - pattern: esc_url($X)
      - pattern: esc_js($X)
      - pattern: wp_kses($X, $ALLOWED)
      - pattern: wp_kses_post($X)
      - pattern: sanitize_text_field($X)
      - pattern: sanitize_user($X, ...)
      - pattern: sanitize_email($X)
      - pattern: htmlspecialchars($X, ...)
      - pattern: strip_tags($X)

    # 3) Sinks (세미콜론 필수)
    pattern-sinks:
      - pattern: echo $SINK;
      - pattern: print $SINK;
      - pattern: printf($F, $SINK, ...);
      - pattern: vprintf($F, $SINKS);
      - pattern: echo sprintf($F, $SINK, ...);
      - pattern: print sprintf($F, $SINK, ...);


